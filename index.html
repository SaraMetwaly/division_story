<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø±Ø­Ù„Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ ğŸ¡ â€” Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‚Ø³Ù…Ø© Ø§Ù„Ù…Ø·ÙˆÙ‘Ù„Ø© </title>
<style>
  :root{--bg:#fff9f1;--panel:#ffffff;--accent:#6a5acd;--text:#1f2d3d;--muted:#6b7280;--shadow:0 8px 24px rgba(0,0,0,.08)}
  *{box-sizing:border-box}
  body{margin:0;font-family:"Tahoma","Segoe UI",system-ui,-apple-system,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
  header{background:linear-gradient(135deg,#ffd27f 0%,#ff9fb2 50%,#c1b4ff 100%);padding:24px 16px 28px;text-align:center;color:#1b1732}
  h1{margin:0 0 6px;font-size:28px}.sub{opacity:.9;font-size:16px}
  .container{max-width:1100px;margin:-24px auto 80px;padding:0 16px}
  .card{background:var(--panel);border-radius:16px;box-shadow:var(--shadow);padding:18px;margin:14px 0}
  .row{display:flex;flex-wrap:wrap;gap:16px}.col{flex:1 1 320px}
  label{display:block;margin:.25rem 0 .35rem;font-weight:700}
  input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #e5e7eb;font-size:18px}
  button{border:0;border-radius:12px;padding:12px 16px;font-size:16px;cursor:pointer;transition:.2s;box-shadow:var(--shadow)}
  .primary{background:var(--accent);color:#fff}.secondary{background:#eef2ff;color:#4338ca}.ghost{background:#f1f5f9;color:#0f172a}
  button:disabled{opacity:.5;cursor:not-allowed}
  .hint{color:var(--muted);font-size:14px}
  .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:#fefce8;border:1px dashed #fde68a;color:#7c2d12}
  .board{display:flex;gap:16px;align-items:stretch;flex-wrap:wrap}
  .gate,.queue,.work{flex:1 1 280px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:14px;padding:14px}
  .title{font-weight:800;margin-bottom:8px}
  .digits{display:flex;gap:8px;flex-wrap:wrap}
  .digit{min-width:44px;padding:10px 12px;border-radius:12px;background:#fff;border:1px solid #e5e7eb;text-align:center;font-weight:800;font-size:20px;box-shadow:var(--shadow)}
  .digit.active{outline:3px solid #60a5fa}
  .qbtns{display:grid;grid-template-columns:repeat(5,minmax(56px,1fr));gap:8px;margin-top:8px}
  .qbtns button{padding:10px 0;font-weight:800;background:#e0f2fe;color:#075985}
  .log{max-height:220px;overflow:auto;border:1px dashed #e5e7eb;border-radius:12px;padding:8px;background:#fff}
  .math{display:flex;align-items:flex-end;gap:10px;font-family:"Consolas","Courier New",monospace;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:10px;min-height:70px}
  .math .item{padding:0 6px}
  .ok{background:#dcfce7;color:#14532d}.no{background:#fee2e2;color:#7f1d1d}
  .footer-note{font-size:12px;color:#6b7280;text-align:center;margin-top:10px}
  .status{margin-top:8px}
</style>
</head>
<body>
<header>
  <h1>Ø±Ø­Ù„Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ ğŸ¡</h1>
</header>

<div class="container">
  <div class="card">
    <div class="row">
      <div class="col">
        <label>Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… (Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø°ÙŠ ÙŠØ±ÙŠØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„):</label>
        <input id="dividend" type="text" value="234" inputmode="numeric" autocomplete="off" />
      </div>
      <div class="col">
        <label>Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡ (Ø§Ù„Ø­Ø§Ø±Ø³ Ø¹Ù†Ø¯ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©):</label>
        <input id="divisor" type="text" value="3" inputmode="numeric" />
      </div>
    </div>
    <div class="row" style="margin-top:10px">
      <div class="col">
        <button id="startBtn" class="primary" onclick="startGame()">Ø§Ø¨Ø¯Ø¦ÙŠ Ø§Ù„Ø±Ø­Ù„Ø© ğŸš€</button>
        <button class="ghost" onclick="resetGame()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
      </div>
    </div>
    <div id="status" class="status"></div>
  </div>

  <div class="card">
    <div class="title">Ø§Ù„Ù‚ØµØ©: "Ø§Ù„Ø­Ø§Ø±Ø³" ÙŠØ¹Ù„Ù† Ø´Ø±Ø· Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
    <div class="hint">ÙŠÙØ³Ù…Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù…Ù† ÙƒØ§Ù† Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ÙŠØ³Ø§ÙˆÙŠ Ø£Ø­Ø¯ <strong>Ù…Ø¶Ø§Ø¹ÙØ§Øª</strong> Ø§Ù„Ø­Ø§Ø±Ø³. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© ÙÙŠ "Ø¯ÙØªØ± Ø§Ù„Ø¯Ø®ÙˆÙ„" (Ø§Ù„Ù†Ø§ØªØ¬).</div>
    <div id="multiples" class="digits" style="margin-top:8px"></div>
  </div>

  <div class="card board">
    <div class="queue">
      <div class="title">Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø§Ù„Ù…Ù‚Ø³ÙˆÙ…)</div>
      <div id="queue" class="digits"></div>
      <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
        <button id="bringBtn" class="secondary" onclick="bringDown()" disabled>Ø£Ù†Ø²Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ â¬‡ï¸</button>
        <span id="bringMsg" class="hint"></span>
      </div>
    </div>

    <div class="gate">
      <div class="title">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø­Ø§Ø±Ø³ ğŸ‘®â€â™‚ï¸ (Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡ = <span id="dText">â€“</span>)</div>
      <div class="math" id="mathArea">
        <div class="item">Ù†Ø§ØªØ¬: <strong id="quotient">â€“</strong></div>
        <div class="item">|</div>
        <div class="item">Ø§Ù„Ø­Ø§Ù„ÙŠ: <strong id="current">â€“</strong></div>
        <div class="item">Ø§Ù„Ø¨Ø§Ù‚ÙŠ: <strong id="remainder">â€“</strong></div>
      </div>
      <div id="choiceWrap" style="margin-top:10px; display:none">
        <div class="hint">Ø§Ø®ØªØ§Ø±ÙŠ ÙƒÙ… Ù…Ø±Ø© ÙŠØ¯Ø®Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ ÙÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ²Ù‡):</div>
        <div class="qbtns" id="choices"></div>
      </div>
      <div id="feedback" style="margin-top:8px"></div>
    </div>

    <div class="work">
      <div class="title">Ø¯ÙØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª âœï¸</div>
      <div class="log" id="log"></div>
      <div class="footer-note">Ø³Ø¬Ù‘Ù„ Ù‡Ù†Ø§ Ù…Ø§ Ø­Ø¯Ø« ÙÙŠ ÙƒÙ„ Ø®Ø·ÙˆØ©: Ø§Ù„Ø¥Ù†Ø²Ø§Ù„ âœ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± âœ Ø§Ù„Ø·Ø±Ø­ âœ Ø§Ù„Ø¨Ø§Ù‚ÙŠ âœ Ø§Ù„Ø¥Ù†Ø²Ø§Ù„...</div>
    </div>
  </div>


</div>

<script>
  // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©/Ø§Ù„ÙØ§Ø±Ø³ÙŠØ© Ø¥Ù„Ù‰ Ù„Ø§ØªÙŠÙ†ÙŠØ© ÙˆØ¬Ù…Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø¥Ø¶Ø§ÙØ§Øª)
  function toAsciiDigitsOnly(s){
    const map = {
      'Ù ':'0','Ù¡':'1','Ù¢':'2','Ù£':'3','Ù¤':'4','Ù¥':'5','Ù¦':'6','Ù§':'7','Ù¨':'8','Ù©':'9',
      'Û°':'0','Û±':'1','Û²':'2','Û³':'3','Û´':'4','Ûµ':'5','Û¶':'6','Û·':'7','Û¸':'8','Û¹':'9'
    };
    let out = "";
    for(const ch of String(s||"")){
      if(ch >= '0' && ch <= '9'){ out += ch; continue; }
      if(map[ch] !== undefined){ out += map[ch]; continue; }
      // ØºÙŠØ± Ø°Ù„Ùƒ Ù†ØªØ¬Ø§Ù‡Ù„Ù‡
    }
    return out;
  }

  let state = {digits:[],idx:0,divisor:0,current:"",quotient:"",remainder:0,done:false,awaitingChoice:false};

  function setStatus(msg){
    const el = document.getElementById('status');
    el.innerHTML = msg ? `<span class="pill">â„¹ï¸ ${msg}</span>` : "";
  }

  function logMsg(html){
    const el = document.getElementById('log'); const row = document.createElement('div');
    row.innerHTML = html; el.prepend(row);
  }

  function paintQueue(){
    const q = document.getElementById('queue'); q.innerHTML = "";
    state.digits.forEach((d,i)=>{
      const div = document.createElement('div');
      div.className = "digit" + (i===state.idx?" active":""); div.textContent = d; q.appendChild(div);
    });
  }

  function paintMultiples(){
    const m = document.getElementById('multiples'); m.innerHTML = "";
    if(!state.divisor) return;
    for(let i=1;i<=10;i++){
      const div = document.createElement('div'); div.className="digit";
      div.textContent = `${state.divisor} Ã— ${i} = ${state.divisor*i}`;
      m.appendChild(div);
    }
  }

  function updateTop(){
    document.getElementById('dText').textContent = state.divisor||"â€“";
    document.getElementById('quotient').textContent = state.quotient||"0";
    document.getElementById('current').textContent = state.current||"0";
    document.getElementById('remainder').textContent = state.remainder||"0";
  }

  function startGame(){
    const rawDividend = document.getElementById('dividend').value;
    const rawDivisor = document.getElementById('divisor').value;

    const dividendStr = toAsciiDigitsOnly(rawDividend);
    const divisorStr  = toAsciiDigitsOnly(rawDivisor);

    const divisor = Number(divisorStr);
    if(!Number.isFinite(divisor) || divisor === 0){
      setStatus("Ø£Ø¯Ø®Ù„ÙŠ Ø±Ù‚Ù…Ù‹Ø§ ØµØ­ÙŠØ­Ù‹Ø§ Ù„Ù„Ø­Ø§Ø±Ø³ (Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡) ÙˆØºÙŠØ± ØµÙØ±ÙŠ Ù…Ø«Ù„ 2 Ø£Ùˆ 3.");
      return;
    }
    setStatus("");

    state = {
      digits: (dividendStr || "0").split(""),
      idx:0,
      divisor:divisor,
      current:"",
      quotient:"",
      remainder:0,
      done:false,
      awaitingChoice:false
    };

    paintMultiples();
    paintQueue();
    document.getElementById('bringBtn').disabled = false;
    document.getElementById('bringMsg').textContent = "Ø§Ø¨Ø¯Ø¦ÙŠ Ø¨Ø¥Ù†Ø²Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„Ø·Ø§Ø¨ÙˆØ±.";
    document.getElementById('choices').innerHTML="";
    document.getElementById('choiceWrap').style.display = "none";
    document.getElementById('feedback').innerHTML="";
    document.getElementById('log').innerHTML="";
    updateTop();
  }

  function resetGame(){
    state = {digits:[],idx:0,divisor:0,current:"",quotient:"",remainder:0,done:false,awaitingChoice:false};
    document.getElementById('multiples').innerHTML="";
    document.getElementById('queue').innerHTML="";
    document.getElementById('choices').innerHTML="";
    document.getElementById('choiceWrap').style.display="none";
    document.getElementById('feedback').innerHTML="";
    document.getElementById('bringBtn').disabled = true;
    document.getElementById('bringMsg').textContent = "";
    document.getElementById('log').innerHTML="";
    setStatus("");
    updateTop();
  }

  function bringDown(){
    if(state.done) return;
    if(state.awaitingChoice){ return; }
    if(state.idx >= state.digits.length){
      document.getElementById('bringMsg').textContent = "Ù„Ø§ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø·Ø§Ø¨ÙˆØ±.";
      return;
    }
    state.current = String(state.current||"") + String(state.digits[state.idx]);
    logMsg(`ğŸ« Ø§Ù†Ø¶Ù… Ø§Ù„Ø±Ù‚Ù… <strong>${state.digits[state.idx]}</strong> Ù…Ù† Ø§Ù„Ø·Ø§Ø¨ÙˆØ± âœ Ø£ØµØ¨Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ <strong>${state.current}</strong>.`);
    state.idx += 1;
    paintQueue();
    updateTop();

    const cur = Number(state.current);
    if(cur < state.divisor && state.idx < state.digits.length){
      state.quotient += "0";
      logMsg(`â³ ${cur} Ø£ØµØºØ± Ù…Ù† ${state.divisor} âœ Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ 0 ÙÙŠ Ø§Ù„Ø¯ÙØªØ±.`);
      updateTop();
      document.getElementById('bringMsg').textContent = "Ø£Ø­Ø³Ù†ØªÙ! Ø£Ù†Ø²Ù„ÙŠ Ø±Ù‚Ù…Ù‹Ø§ Ø¢Ø®Ø±.";
      document.getElementById('choiceWrap').style.display = "none";
      return;
    }

    if(cur >= state.divisor){
      showChoices();
      document.getElementById('bringMsg').textContent = "Ø§Ø®ØªØ§Ø±ÙŠ ÙƒÙ… Ù…Ø±Ø© ÙŠØ¯Ø®Ù„ Ø§Ù„Ø­Ø§Ø±Ø³.";
    }else{
      finish(true);
    }
  }

  function showChoices(){
    state.awaitingChoice = true;
    document.getElementById('bringBtn').disabled = true;

    const cur = Number(state.current);
    const correct = Math.floor(cur / state.divisor);
    const set = new Set([correct]);
    while(set.size<8){
      const r = Math.max(0, correct + Math.floor(Math.random()*7)-3);
      set.add(r);
    }
    const arr = Array.from(set).slice(0,8).sort((a,b)=>a-b);
    const wrap = document.getElementById('choices'); wrap.innerHTML = "";
    arr.forEach(n=>{
      const b = document.createElement('button'); b.textContent = n;
      b.onclick = ()=> chooseQuotient(n); wrap.appendChild(b);
    });
    document.getElementById('choiceWrap').style.display = "block";
  }

  function chooseQuotient(n){
    if(!state.awaitingChoice) return;
    const cur = Number(state.current);
    const correct = Math.floor(cur/state.divisor);
    const fb = document.getElementById('feedback');
    if(n!==correct){ fb.innerHTML = `<span class="no">Ø­Ø§ÙˆÙ„ÙŠ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</span>`; return; }
    state.quotient += String(n);
    const product = n * state.divisor;
    const remainder = cur - product;
    state.current = String(remainder);
    state.remainder = remainder;
    fb.innerHTML = `<span class="ok">âœ”ï¸ ØµØ­ÙŠØ­</span> ${state.divisor} Ã— ${n} = ${product} â€” Ø§Ù„Ø¨Ø§Ù‚ÙŠ ${remainder}.`;
    logMsg(`âœ… Ø·Ø±Ø­Ù†Ø§ ${product} Ù…Ù† ${cur} âœ Ø§Ù„Ø¨Ø§Ù‚ÙŠ <strong>${remainder}</strong>.`);
    updateTop();
    document.getElementById('choiceWrap').style.display = "none";
    state.awaitingChoice = false;
    document.getElementById('bringBtn').disabled = false;

    if(state.idx >= state.digits.length){ finish(false); }
    else{ document.getElementById('bringMsg').textContent = "Ø£Ù†Ø²Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ."; }
  }

  function finish(smallAtEnd){
    state.done = true; state.awaitingChoice = false;
    document.getElementById('bringBtn').disabled = true;
    const rem = smallAtEnd ? Number(state.current||"0") : state.remainder||0;
    const msg = `ğŸ‰ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø±Ø­Ù„Ø©: Ø§Ù„Ù†Ø§ØªØ¬ <strong>${state.quotient||0}</strong> ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ <strong>${rem}</strong>.`;
    logMsg(msg);
    document.getElementById('feedback').innerHTML = `<span class="pill">ğŸŠ ${msg}</span>`;
  }

  // Ø§Ø®ØªØµØ§Ø±: Enter = Ø¥Ù†Ø²Ø§Ù„ØŒ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… = Ø§Ø®ØªÙŠØ§Ø±
  document.addEventListener('keydown', (e)=>{
    const active = document.activeElement;
    if(active && (active.tagName === 'INPUT' || active.isContentEditable)) return;
    if(e.key === 'Enter'){
      if(!state.awaitingChoice && !document.getElementById('bringBtn').disabled){ bringDown(); }
    }
    if(/^[0-9]$/.test(e.key) && state.awaitingChoice){ chooseQuotient(Number(e.key)); }
  });
</script>
</body>
</html>
