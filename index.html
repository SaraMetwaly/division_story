<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø±Ø­Ù„Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ ğŸ¡ â€” Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‚Ø³Ù…Ø© Ø§Ù„Ù…Ø·ÙˆÙ‘Ù„Ø© (Ø¥ØµØ¯Ø§Ø± Ù…ÙØ­Ø³Ù‘ÙÙ†)</title>
<style>
  :root{
    --bg:#fff9f1;
    --panel:#ffffff;
    --accent:#6a5acd;
    --accent2:#00a67d;
    --text:#1f2d3d;
    --muted:#6b7280;
    --bad:#c2410c;
    --good:#2563eb;
    --shadow:0 8px 24px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: "Tahoma", "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
    background: var(--bg);
    color:var(--text);
    line-height:1.8;
  }
  header{
    background: linear-gradient(135deg, #ffd27f 0%, #ff9fb2 50%, #c1b4ff 100%);
    padding:24px 16px 28px;
    text-align:center;
    color:#1b1732;
  }
  h1{margin:0 0 6px;font-size:28px}
  .sub{opacity:.9;font-size:16px}
  .container{max-width:1100px;margin:-24px auto 80px;padding:0 16px}
  .card{
    background:var(--panel);
    border-radius:16px;
    box-shadow:var(--shadow);
    padding:18px;
    margin:14px 0;
  }
  .row{display:flex;flex-wrap:wrap;gap:16px}
  .col{flex:1 1 320px}
  label{display:block;margin:.25rem 0 .35rem;font-weight:700}
  input{
    width:100%;padding:12px 14px;border-radius:12px;border:1px solid #e5e7eb;
    font-size:18px;
  }
  button{
    border:0;border-radius:12px;padding:12px 16px;font-size:16px;cursor:pointer;
    transition:.2s; box-shadow:var(--shadow);
  }
  button.primary{background:var(--accent);color:#fff}
  button.secondary{background:#eef2ff;color:#4338ca}
  button.ghost{background:#f1f5f9;color:#0f172a}
  button:disabled{opacity:.5;cursor:not-allowed;filter:grayscale(.2)}
  .hint{color:var(--muted);font-size:14px}
  .pill{
    display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;
    background:#f0fdf4;color:#14532d;border:1px dashed #86efac;margin:4px 6px 0 0;font-size:14px
  }
  .board{display:flex;gap:16px;align-items:stretch;flex-wrap:wrap}
  .gate,.queue,.work{
    flex:1 1 280px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:14px;padding:14px;
  }
  .title{font-weight:800;margin-bottom:8px}
  .digits{display:flex;gap:8px;flex-wrap:wrap}
  .digit{
    min-width:44px;padding:10px 12px;border-radius:12px;background:#fff;border:1px solid #e5e7eb;
    text-align:center;font-weight:800;font-size:20px;box-shadow:var(--shadow);
  }
  .digit.active{outline:3px solid #60a5fa}
  .stack{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
  .qbtns{display:grid;grid-template-columns:repeat(5,minmax(56px,1fr));gap:8px;margin-top:8px}
  .qbtns button{padding:10px 0;font-weight:800;background:#e0f2fe;color:#075985}
  .log{
    max-height:220px;overflow:auto;border:1px dashed #e5e7eb;border-radius:12px;padding:8px;background:#fff
  }
  .math{
    display:flex;align-items:flex-end;gap:10px;font-family:"Consolas","Courier New",monospace;
    background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:10px;min-height:70px
  }
  .math .item{padding:0 6px}
  .badge{display:inline-block;background:#fef3c7;color:#92400e;padding:4px 8px;border-radius:10px;margin-inline-start:6px}
  .ok{background:#dcfce7;color:#14532d}
  .no{background:#fee2e2;color:#7f1d1d}
  .flex{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .footer-note{font-size:12px;color:#6b7280;text-align:center;margin-top:10px}
  .kbd{font-family:monospace; background:#fff; border:1px solid #e5e7eb; border-radius:6px; padding:0 6px}
</style>
</head>
<body>
<header>
  <h1>Ø±Ø­Ù„Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ ğŸ¡</h1>
  <div class="sub">Ù„Ø¹Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ© ØªÙØ­Ø§ÙƒÙŠ Ø§Ù„Ù‚Ø³Ù…Ø© Ø§Ù„Ù…Ø·ÙˆÙ‘Ù„Ø© Ø¹Ø¨Ø± Ù‚ØµØ© "Ø§Ù„Ø­Ø§Ø±Ø³" (Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡) Ùˆ"Ø¯ÙØªØ± Ø§Ù„Ø¯Ø®ÙˆÙ„" (Ø§Ù„Ù†Ø§ØªØ¬) Ùˆ"Ø§Ù„Ø¨Ø§Ù‚ÙŠ" ğŸ¢</div>
</header>

<div class="container">
  <div class="card">
    <div class="row">
      <div class="col">
        <label>Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… (Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø°ÙŠ ÙŠØ±ÙŠØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„):</label>
        <input id="dividend" type="text" value="845" inputmode="numeric" autocomplete="off" />
      </div>
      <div class="col">
        <label>Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡ (Ø§Ù„Ø­Ø§Ø±Ø³ Ø¹Ù†Ø¯ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©):</label>
        <input id="divisor" type="number" value="7" min="2" max="99" />
      </div>
    </div>
    <div class="row" style="margin-top:10px">
      <div class="col">
        <button id="startBtn" class="primary" onclick="startGame()">Ø§Ø¨Ø¯Ø¦ÙŠ Ø§Ù„Ø±Ø­Ù„Ø© ğŸš€</button>
        <button class="ghost" onclick="resetGame()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
      </div>
      <div class="col" style="display:flex;justify-content:flex-end;align-items:center">
        <span class="pill">ğŸ’¡ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­: <span class="kbd">Enter</span> Ù„Ø¥Ù†Ø²Ø§Ù„ Ø§Ù„Ø±Ù‚Ù…ØŒ ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù… <span class="kbd">0â€“9</span> Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±.</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="title">Ø§Ù„Ù‚ØµØ©: "Ø§Ù„Ø­Ø§Ø±Ø³" ÙŠØ¹Ù„Ù† Ø´Ø±Ø· Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
    <div class="hint">ÙŠÙØ³Ù…Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù…Ù† ÙƒØ§Ù† Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ÙŠØ³Ø§ÙˆÙŠ Ø£Ø­Ø¯ <strong>Ù…Ø¶Ø§Ø¹ÙØ§Øª</strong> Ø§Ù„Ø­Ø§Ø±Ø³. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© ÙÙŠ "Ø¯ÙØªØ± Ø§Ù„Ø¯Ø®ÙˆÙ„" (Ø§Ù„Ù†Ø§ØªØ¬).</div>
    <div id="multiples" class="digits" style="margin-top:8px"></div>
  </div>

  <div class="card board">
    <div class="queue">
      <div class="title">Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø§Ù„Ù…Ù‚Ø³ÙˆÙ…)</div>
      <div id="queue" class="digits"></div>
      <div style="margin-top:10px" class="flex">
        <button id="bringBtn" class="secondary" onclick="bringDown()" disabled>Ø£Ù†Ø²Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ â¬‡ï¸</button>
        <span id="bringMsg" class="hint"></span>
      </div>
    </div>

    <div class="gate">
      <div class="title">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø­Ø§Ø±Ø³ ğŸ‘®â€â™‚ï¸ (Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡ = <span id="dText">â€“</span>)</div>
      <div class="math" id="mathArea">
        <div class="item">Ù†Ø§ØªØ¬: <strong id="quotient">â€“</strong></div>
        <div class="item">|</div>
        <div class="item">Ø§Ù„Ø­Ø§Ù„ÙŠ: <strong id="current">â€“</strong></div>
        <div class="item">Ø§Ù„Ø¨Ø§Ù‚ÙŠ: <strong id="remainder">â€“</strong></div>
      </div>
      <div id="choiceWrap" style="margin-top:10px; display:none">
        <div class="hint">Ø§Ø®ØªØ§Ø±ÙŠ ÙƒÙ… Ù…Ø±Ø© ÙŠØ¯Ø®Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ ÙÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ²Ù‡):</div>
        <div class="qbtns" id="choices"></div>
      </div>
      <div id="feedback" style="margin-top:8px"></div>
    </div>

    <div class="work">
      <div class="title">Ø¯ÙØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª âœï¸</div>
      <div class="log" id="log"></div>
      <div class="footer-note">Ø³Ø¬Ù‘Ù„ Ù‡Ù†Ø§ Ù…Ø§ Ø­Ø¯Ø« ÙÙŠ ÙƒÙ„ Ø®Ø·ÙˆØ©: Ø§Ù„Ø¥Ù†Ø²Ø§Ù„ âœ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± âœ Ø§Ù„Ø·Ø±Ø­ âœ Ø§Ù„Ø¨Ø§Ù‚ÙŠ âœ Ø§Ù„Ø¥Ù†Ø²Ø§Ù„...</div>
    </div>
  </div>

  <div class="card">
    <div class="title">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ø¹Ø¨ Ø³Ø±ÙŠØ¹Ù‹Ø§</div>
    <ol>
      <li>Ø£Ø¯Ø®Ù„ÙŠ Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… ÙˆØ§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡ Ø«Ù… Ø§Ø¶ØºØ·ÙŠ <strong>Ø§Ø¨Ø¯Ø¦ÙŠ Ø§Ù„Ø±Ø­Ù„Ø©</strong>.</li>
      <li>Ø§Ø¶ØºØ·ÙŠ <strong>Ø£Ù†Ø²Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ</strong> Ø­ØªÙ‰ ÙŠØµØ¨Ø­ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ â‰¥ Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡.</li>
      <li>Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­ Ù„Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø­Ø§Ø±Ø³. Ø¨Ø¹Ø¯Ù‡Ø§ ÙŠØªÙ… Ø§Ù„Ø·Ø±Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</li>
      <li>Ø§Ø³ØªÙ…Ø±ÙŠ Ø­ØªÙ‰ ØªÙ†ØªÙ‡ÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…. Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ù†Ø§ØªØ¬ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù…Ø¹ ØªÙ‡Ù†Ø¦Ø© ğŸ‰.</li>
    </ol>
  </div>

  <div class="footer-note">Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ø£Ùˆ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª â€” ÙŠØ¹Ù…Ù„ Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª.</div>

</div>

<script>
  let state = {
    digits: [], idx: 0,
    divisor: 0,
    current: "",
    quotient: "",
    remainder: 0,
    done:false,
    awaitingChoice:false
  };

  function logMsg(html){
    const el = document.getElementById('log');
    const row = document.createElement('div');
    row.innerHTML = html;
    el.prepend(row);
  }

  function paintQueue(){
    const q = document.getElementById('queue');
    q.innerHTML = "";
    state.digits.forEach((d,i)=>{
      const div = document.createElement('div');
      div.className = "digit" + (i===state.idx?" active":"");
      div.textContent = d;
      q.appendChild(div);
    });
  }

  function paintMultiples(){
    const m = document.getElementById('multiples');
    m.innerHTML = "";
    if(!state.divisor) return;
    for(let i=1;i<=10;i++){
      const div = document.createElement('div');
      div.className="digit";
      div.textContent = `${state.divisor} Ã— ${i} = ${state.divisor*i}`;
      m.appendChild(div);
    }
  }

  function updateTop(){
    document.getElementById('dText').textContent = state.divisor||"â€“";
    document.getElementById('quotient').textContent = state.quotient||"0";
    document.getElementById('current').textContent = state.current||"0";
    document.getElementById('remainder').textContent = state.remainder||"0";
  }

  function startGame(){
    const dividend = document.getElementById('dividend').value.replace(/\\s+/g,'');
    const divisor = parseInt(document.getElementById('divisor').value,10);

    if(!/^\\d+$/.test(dividend)){
      alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… ÙƒØ£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·.");
      return;
    }
    if(!Number.isFinite(divisor) || divisor < 2 || divisor > 99){
      alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡ Ø¨ÙŠÙ† 2 Ùˆ 99.");
      return;
    }

    state = {
      digits: dividend.split('').map(x=>+x),
      idx:0,
      divisor:divisor,
      current:"",
      quotient:"",
      remainder:0,
      done:false,
      awaitingChoice:false
    };

    paintMultiples();
    paintQueue();
    document.getElementById('bringBtn').disabled = false;
    document.getElementById('bringMsg').textContent = "Ø§Ø¨Ø¯Ø¦ÙŠ Ø¨Ø¥Ù†Ø²Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„Ø·Ø§Ø¨ÙˆØ±.";
    document.getElementById('choices').innerHTML="";
    document.getElementById('choiceWrap').style.display = "none";
    document.getElementById('feedback').innerHTML="";
    document.getElementById('log').innerHTML="";
    updateTop();
  }

  function resetGame(){
    state = {digits:[],idx:0,divisor:0,current:"",quotient:"",remainder:0,done:false,awaitingChoice:false};
    document.getElementById('dividend').value = "845";
    document.getElementById('divisor').value = "7";
    document.getElementById('multiples').innerHTML="";
    document.getElementById('queue').innerHTML="";
    document.getElementById('choices').innerHTML="";
    document.getElementById('choiceWrap').style.display="none";
    document.getElementById('feedback').innerHTML="";
    document.getElementById('bringBtn').disabled = true;
    document.getElementById('bringMsg').textContent = "";
    document.getElementById('log').innerHTML="";
    updateTop();
  }

  function bringDown(){
    if(state.done) return;
    if(state.awaitingChoice){
      // Ø£Ù…Ø§Ù† Ø¥Ø¶Ø§ÙÙŠ ÙÙŠ Ø­Ø§Ù„ ØªÙ…ÙƒÙ‘Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù†Ù‚Ø± Ø¹Ø¨Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
      return;
    }
    if(state.idx >= state.digits.length){
      document.getElementById('bringMsg').textContent = "Ù„Ø§ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø·Ø§Ø¨ÙˆØ±.";
      return;
    }
    // Ø¶Ù… Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ
    state.current = String(state.current||"") + String(state.digits[state.idx]);
    logMsg(`ğŸ« Ø§Ù†Ø¶Ù… Ø§Ù„Ø±Ù‚Ù… <strong>${state.digits[state.idx]}</strong> Ù…Ù† Ø§Ù„Ø·Ø§Ø¨ÙˆØ± âœ Ø£ØµØ¨Ø­ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ <strong>${state.current}</strong>.`);
    state.idx += 1;
    paintQueue();
    updateTop();

    // Ù‡Ù„ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ø­Ø§Ø±Ø³ØŸ
    const cur = parseInt(state.current,10);
    if(cur < state.divisor && state.idx < state.digits.length){
      // Ù†Ø¶ÙŠÙ ØµÙØ±Ù‹Ø§ Ù„Ù„Ù†Ø§ØªØ¬ ÙˆÙ†Ø·Ù„Ø¨ Ø¥Ù†Ø²Ø§Ù„ Ø±Ù‚Ù… Ø¢Ø®Ø±
      state.quotient += "0";
      logMsg(`â³ Ø§Ù„Ø¹Ø¯Ø¯ <strong>${cur}</strong> Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ø­Ø§Ø±Ø³ <strong>${state.divisor}</strong> âœ Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ <span class="badge">0</span> ÙÙŠ Ø¯ÙØªØ± Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ø§Ù†ØªØ¸Ø§Ø± ØµØ¯ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰).`);
      updateTop();
      document.getElementById('bringMsg').textContent = "Ø£Ø­Ø³Ù†ØªÙ! Ù…Ø§ ÙŠØ²Ø§Ù„ Ø§Ù„Ø¹Ø¯Ø¯ ØµØºÙŠØ±Ù‹Ø§ â€” Ø£Ù†Ø²Ù„ÙŠ Ø±Ù‚Ù…Ù‹Ø§ Ø¢Ø®Ø±.";
      document.getElementById('choiceWrap').style.display = "none";
      return;
    }

    // Ø¥Ø°Ø§ Ø£ØµØ¨Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒØ§ÙÙŠÙ‹Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª
    if(cur >= state.divisor){
      showChoices();
      document.getElementById('bringMsg').textContent = "Ø§Ù„Ø¢Ù† Ø§Ø®ØªØ§Ø±ÙŠ ÙƒÙ… Ù…Ø±Ø© ÙŠØ¯Ø®Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ ÙÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ.";
    }else{
      // Ù„Ø§ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆÙ…Ø¹ Ø°Ù„Ùƒ Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡
      // Ù‡Ø°Ø§ Ø³ÙŠÙƒÙˆÙ† Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
      finish(true);
    }
  }

  function showChoices(){
    state.awaitingChoice = true;
    document.getElementById('bringBtn').disabled = true;

    const cur = parseInt(state.current,10);
    const correct = Math.floor(cur / state.divisor);
    const set = new Set([correct]);
    while(set.size<8){
      const r = Math.max(0, correct + Math.floor(Math.random()*7)-3); // Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø´ØªØªØ§Øª
      set.add(r);
    }
    const arr = Array.from(set).slice(0,8).sort((a,b)=>a-b);
    const wrap = document.getElementById('choices');
    wrap.innerHTML = "";
    arr.forEach(n=>{
      const b = document.createElement('button');
      b.textContent = n;
      b.onclick = ()=> chooseQuotient(n);
      b.setAttribute('data-choice', n);
      wrap.appendChild(b);
    });
    document.getElementById('choiceWrap').style.display = "block";
  }

  function chooseQuotient(n){
    if(!state.awaitingChoice) return;
    const cur = parseInt(state.current,10);
    const correct = Math.floor(cur/state.divisor);
    const fb = document.getElementById('feedback');
    if(n!==correct){
      fb.innerHTML = `<span class="badge no">Ø­Ø§ÙˆÙ„ÙŠ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</span> ${n} ÙƒØ¨ÙŠØ±/ØµØºÙŠØ± Ù„Ø§ ÙŠÙ†Ø§Ø³Ø¨ ${cur} Ã· ${state.divisor}.`;
      return;
    }
    // ØµØ­ÙŠØ­
    state.quotient += String(n);
    const product = n * state.divisor;
    const remainder = cur - product;
    state.current = String(remainder);
    state.remainder = remainder;
    fb.innerHTML = `<span class="badge ok">Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</span> ${state.divisor} Ã— ${n} = ${product}ØŒ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¢Ù† ${remainder}.`;
    logMsg(`âœ… Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø­Ø§Ø±Ø³ <strong>${n}</strong> ÙÙŠ Ø§Ù„Ø¯ÙØªØ± âœ Ø·Ø±Ø­Ù†Ø§ ${product} Ù…Ù† ${cur} ÙØªØ¨Ù‚Ù‘Ù‰ <strong>${remainder}</strong>.`);
    updateTop();
    // Ø£Ø®ÙÙ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø­ØªÙ‰ Ø¥Ù†Ø²Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ
    document.getElementById('choiceWrap').style.display = "none";
    state.awaitingChoice = false;
    document.getElementById('bringBtn').disabled = false;

    // Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙƒÙ„Ù‡Ø§
    if(state.idx >= state.digits.length){
      finish(false);
    }else{
      document.getElementById('bringMsg').textContent = "Ø±Ø§Ø¦Ø¹! Ø£Ù†Ø²Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ Ù…Ù† Ø§Ù„Ø·Ø§Ø¨ÙˆØ±.";
    }
  }

  function finish(smallAtEnd){
    state.done = true;
    state.awaitingChoice = false;
    document.getElementById('bringBtn').disabled = true;
    let msg = "";
    if(smallAtEnd){
      // Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø£ÙÙ†Ø²Ù„Øª Ù„ÙƒÙ† Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡
      msg = `ğŸ‰ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø±Ø­Ù„Ø©: Ø§Ù„Ù†Ø§ØªØ¬ <strong>${state.quotient||0}</strong> ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ <strong>${parseInt(state.current||"0",10)}</strong>.`;
    }else{
      msg = `ğŸ‰ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø±Ø­Ù„Ø©: Ø§Ù„Ù†Ø§ØªØ¬ <strong>${state.quotient||0}</strong> ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ <strong>${state.remainder||0}</strong>.`;
    }
    logMsg(msg);
    document.getElementById('feedback').innerHTML = `<div class="pill">ğŸŠ ${msg}</div>`;
    confetti();
  }

  // Ø¨Ø³ÙŠØ· Ø¬Ø¯Ù‹Ø§: Ù‚Ù„ÙˆØ¨ ÙˆÙ†Ø¬ÙˆÙ… ØªØªØ³Ø§Ù‚Ø·
  function confetti(){
    const emojis = ["ğŸˆ","ğŸ‰","â­","ğŸ¡","ğŸ¢","ğŸŠ"];
    let n = 24;
    const i = setInterval(()=>{
      const s = document.createElement('div');
      s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      s.style.position="fixed";
      s.style.fontSize = (16+Math.random()*20)+"px";
      s.style.top = "-10px";
      s.style.left = (Math.random()*100)+"vw";
      s.style.transition="transform 2.2s ease, opacity 2.2s ease";
      s.style.zIndex=9999;
      document.body.appendChild(s);
      requestAnimationFrame(()=>{
        s.style.transform = `translateY(${(80+Math.random()*120)}vh) rotate(${Math.random()*360}deg)`;
        s.style.opacity = .1;
      });
      setTimeout(()=>document.body.removeChild(s),2300);
      if(--n<=0) clearInterval(i);
    },80);
  }

  // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
  document.addEventListener('keydown', (e)=>{
    // ØªØ¬Ø§Ù‡Ù„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
    const active = document.activeElement;
    if(active && (active.tagName === 'INPUT' || active.isContentEditable)) return;

    if(e.key === 'Enter'){
      if(!state.awaitingChoice && !document.getElementById('bringBtn').disabled){
        bringDown();
      }
    }
    if(/^[0-9]$/.test(e.key)){
      if(state.awaitingChoice){
        chooseQuotient(parseInt(e.key,10));
      }
    }
  });
</script>
</body>
</html>
